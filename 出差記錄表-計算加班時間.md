我有一份出勤記錄表，請幫我分析一下，我想要知道每個人的每天加班的時間，
我想要將這份出勤記錄表，上傳到網頁上，然後自動計算每個人的加班時間及有無誤食費，
幫我寫一個 Recat ＋ TypeScript 程式，來實現這個功能。

#### 加班規則如下：
1. 星期一到星期五的加班開始時間是 18:00， 超過 19:30(含)之後有給誤食費 50元，
2. 星期六是休息日，一上班打卡就開始算加班，到下班打卡為止，沒有誤食費，
3. 星期日是例假日，一上班打卡就開始算加班，到下班打卡為止，沒有誤食費。
   //增加


#### 作業流程：
1. 準備好上傳的 csv 或 TXT 檔，然後上傳。
2. 系統判斷csv / TXT 格式是否正確，不正確顯示警告訊息，正確則載入內容。
3. 然後開始計算加班時數，及是否有誤餐費。
4. 增加欄位：加班原因、加班時間。
5. 欄位要有：員工編號、姓名、日期、加班原因、上班時間、下班時間、加班時間、加班時數、誤餐費。
6. 然後網頁呈現結果，然後開放編輯模式，讓 user 編輯加班原因。
7. 完成編輯後，儲存，然後user自行決定是要下載檔案或是列印出來。
---
### 擴充需求1：
需求分析與差異比較
目前系統 vs. 新需求：
1. 資料欄位擴充：
    - 新增：「加班原因」（需可編輯）
    - 新增：「加班時間」（具體的時間區段，例如 18:00 - 20:00，有別於原本只有「加班時數」）
    - 最終顯示欄位順序建議：員工編號、姓名、日期、加班原因、上班時間、下班時間、加班時間、加班時數、誤餐費。
2. 互動模式改變：
    - 原本：上傳 -> 計算 -> 檢視/下載。
    - 現在：上傳 -> 計算 -> 線上編輯 (填寫加班原因) -> 儲存 -> 下載/列印。
    - 這意味著 AttendanceTable 需要轉變為可編輯的表格（至少「加班原因」這一欄），或者提供一個「編輯模式」的切換。
3. 計算邏輯調整 (需確認細節)：
- 「加班時間」欄位：系統需自動產生加班的起訖時間字串。
    - 平日：固定從 18:00 開始到下班時間 (或下班時間若早於 18:00 則無)。
    - 假日：上班時間 到 下班時間。
    - 加班時數小於 30 分鐘的不計算加班時間。說明：
      - 加班時間 18:00 ～ 18:25，不到30分鐘不計算。
      - 加班時間 18:00 ～ 18:45，加班時間45分鐘，但不到1小時，算30分鐘。
      - 加班時間 18:00 ～ 19:15，加班時間1小時15分鐘，算1小時。
      - 加班時間 18:00 ～ 19:45，加班時間1小時45分鐘，算1.5小時。
---
### 擴充需求2：
1. 工作地點：下拉選取
2. 記憶輸入的「加班原因」，可加入常用的清單，日後可以選用，也可刪掉。
3. 在首頁 及 預覽頁 的日期欄 格式：yyyy/MM/DD ddd 或 yyy/MM/dd dddd
4. 預覽頁增加「備註」欄供編輯，此欄不一定要寫。
5. 當該日的選擇欄勾起來，不論是否有請假，應打開「加班原因」欄供編輯。
   - 前提要有打卡

--- 
### 增加欄位及判斷
1.  增加欄位：
    - 增加：考勤別、數量。
    - CSV檔欄位名稱：員工編號、姓名、歸屬日期、考勤別、數量、上班時間、下班時間
2. 上傳CSV檔，增加「考勤別」的欄位，類別有：
    - 事假
    - 病假
    - 請年休假
    - 公假
    - 空（預設）
3.  數量就是請假天數，通常1日，或0.5日為基礎。
4.  「加班原因」欄是否開放編輯，依考勤別判斷：
    - 如果是空，表示那天有上班，則開放編輯，但是還是要依照「加班時間」欄位的標準來決定。
    - 其餘只要有請假，就將請假原因顯示在該欄上：請XX假。
    - 請假類別不是上述所列，就顯示錯誤原因，重新再上傳。
5.  表單輸出格式：參考上傳的空白表單。
    - 計算完畢後，完成加班原因的編輯，按下載或列印，先預覽顯示結果，沒有問題再進行。
---  
### 空白員工加班申請表 與 CSV 檔 欄位對應 
#### 表格欄位對應
| 員工加班單 | CSV檔 | 說明 |
|----------|-------|-----|
|員工姓名 | 員工編號+姓名| 填入 CSV檔的 員工編號、姓名 |
|工作地點 | | 保留不動|
|備註 | |  保留不動|
|日期|歸屬日期||
|時間|加班開始時間 ～ 下班時間||
|加班原因||依考勤別判斷|
|加班時數||計算加班的時數|
|誤餐費|誤餐費||
|合計||  保留不動|

其他問題回覆：
1. 表頭資訊
   - 申請年月：對應到 TXT的 時間範圍的年月
2. 表格欄位：如上述表格欄位對應
3. 簽核欄位
   - 不需要簽核，也不需要備註欄。
4. 表格樣式
   - 在公司名字左邊加上公司的Logo。
   - 輸出的EXCEL、PDF檔維持我提供的 20251208_空白員工加班申請表 的所有格式與欄位。
   - 頁尾加上頁碼。
   - 其他不用再加。

#### TXT 轉換 CSV → 系統計算 → 完整資料 
##### 階段 1：TXT 原始報表 → CSV 中間檔
|TXT 欄位|	範例值|	CSV 欄位|	轉換邏輯|
|---|----|----|----|
|員工姓名|	100057 鄒東良|	員工編號 + 姓名|	分割為 100057 和 鄒東良|
|歸屬日期|/班別	1141104/1|	歸屬日期|	取 1141104|
|考勤別|/數量/...	病假/1日//1141103 - 1141103|	考勤別 + 數量|	解析為 病假 和 1|
|（無考勤別時）|	空白|	考勤別|	填入空字串 ""|
|刷卡日期| 時間（上班）	1141104 08:38|	上班時間|	取時間部分 08:38|
|刷卡日期| 時間（下班）	1141104 19:14|	下班時間|	取時間部分 19:14|

##### 轉換後的 CSV 格式
```ts
員工編號,姓名,歸屬日期,考勤別,數量,上班時間,下班時間
100057,鄒東良,1141104,,0,08:38,19:14
100057,鄒東良,1141103,病假,1,,
100057,鄒東良,1141101,,0,08:37,17:06
```

##### 階段 2：CSV 中間檔 → 系統計算 → 完整資料
系統會自動計算並新增以下欄位：
|計算項目	|來源	|計算邏輯|
|---|---|---|
|加班時間	|上班時間 + 下班時間 + 星期	|平日：18:00 - 下班時間<br>週六日：上班時間 - 下班時間|
|加班時數	|時間差	|轉換為小時數（保留2位小數）|
|誤餐費	|下班時間 + 星期	|平日且 下班時間 >= 19:30 → 50<br>其他 → 0|
|加班原因	|考勤別	|若有請假 → 請XX假<br>若無 → 可編輯|

```ts
員工編號,姓名,歸屬日期,考勤別,數量,上班時間,下班時間
100057,鄒東良,1141104,,0,08:38,19:14
100057,鄒東良,1141103,病假,1,,
100057,鄒東良,1141101,,0,08:37,17:06
```

##### 階段 3：完整資料 → PDF 輸出
|PDF 欄位（加班申請表）	|資料來源	|範例值|
|---|---|---|
|員工姓名	|員工編號 + 姓名	|100057 鄒東良|
|工作地點	|固定值	（|空白或公司地址）|
|備註	|固定值	（|空白）|
|日期	|歸屬日期	|1141104 或 2025/11/04
|時間	|加班時間	|18:00 - 19:14|
|加班原因	加|班原因	|專案趕工 或 請病假|
|加班時數	|加班時數	1|.23|
|誤餐費	|誤餐費	|50|
|合計	自動加總	（月度統計）|


##### 📄 PDF 輸出範例（簡化版）
根據 100057-11411.TXT 的資料，產生的 PDF 應該長這樣：

═══════════════════════════════════════════════════════════════
                   海灣國際股份有限公司員工加班申請表
                        申請年月：114年11月
═══════════════════════════════════════════════════════════════

員工姓名：100057 鄒東良              工作地點：               
備註：                                                        

───────────────────────────────────────────────────────────────
 日期     │  時間          │ 加班原因   │ 加班時數 │ 誤餐費
───────────────────────────────────────────────────────────────
1141101(六)│ 08:37-17:06   │          │   8.48   │   0
1141103(一)│               │ 請病假    │   0.00   │   0
1141104(二)│ 18:00-19:14   │          │   1.23   │  50
1141105(三)│ 18:00-19:43   │          │   1.72   │  50
1141106(四)│ 18:00-19:32   │          │   1.53   │  50
1141107(五)│ 18:00-20:16   │          │   2.27   │  50
1141108(六)│ 08:53-17:04   │          │   8.18   │   0
1141110(一)│ 18:00-18:27   │          │   0.45   │   0
1141111(二)│               │ 請年休假  │   0.00   │   0
1141112(三)│ 18:00-20:01   │          │   2.02   │  50
1141113(四)│ 18:00-19:38   │          │   1.63   │  50
1141114(五)│ 18:00-20:21   │          │   2.35   │  50
1141115(六)│ 08:55-17:06   │          │   8.18   │   0
1141117(一)│ 18:00-18:08   │          │   0.13   │   0
1141118(二)│ 18:00-19:00   │          │   1.00   │  50
1141119(三)│ 18:00-19:12   │          │   1.20   │  50
1141120(四)│               │ 請年休假  │   0.00   │   0
1141121(五)│ 18:00-20:14   │          │   2.23   │  50
1141122(六)│ 08:56-17:04   │          │   8.13   │   0
1141124(一)│               │ 請年休假  │   0.00   │   0
1141125(二)│ 18:00-18:13   │          │   0.22   │   0
1141126(三)│ 18:00-19:04   │          │   1.07   │  50
1141127(四)│ 18:00-20:10   │          │   2.17   │  50
1141128(五)│ 18:00-20:32   │          │   2.53   │  50
1141129(六)│ 08:50-17:02   │          │   8.20   │   0
───────────────────────────────────────────────────────────────
合計                                  │  61.13   │ 600
═══════════════════════════════════════════════════════════════
                                                    頁碼：1



問題：
1. 上傳TXT格式有錯，要提出警告。
2. 計算加班時數，以30分鐘為單位，比如 
   - 18:00 ～ 19:45，算 1.5小時。
   - 08:56 ～ 17:04，就從 09:00開始算，到 17:00，加班時數為 8小時。
3. 預覽頁、PDF，也要有頁碼。
4. 沒有填寫加班原因，不能進行後續作業。